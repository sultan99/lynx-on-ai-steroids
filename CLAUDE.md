# Lynx on AI Steroids

ReactLynx cross-platform app with Android APK support. Uses Lynx SDK to render React-like components natively on mobile devices.

## Tech Stack

- **UI**: ReactLynx (`@lynx-js/react`) — React-like API targeting the Lynx rendering engine
- **Bundler**: Rspeedy (`@lynx-js/rspeedy`) — Rsbuild-based bundler for Lynx apps
- **Lynx SDK**: 3.6.0 (`@lynx-js/types`)
- **Android**: Kotlin, Gradle 8.5, AGP 8.5.0
- **Testing**: Vitest, Testing Library
- **Language**: TypeScript 5.9

## Project Structure

This project follows [Feature-Sliced Design](https://feature-sliced.design/) (FSD) with `screens/` instead of `pages/` (mobile convention).

```
src/
  app/                  # App shell — entry, providers, global config
    routes/             # TanStack Router — thin route files + auto-generated tree
  screens/              # Screen-level compositions (one folder per screen)
  widgets/              # Self-contained UI blocks composed from features + entities
  features/             # Reusable product actions (auth, theme-switcher, etc.)
  entities/             # Business domain objects (user, article, etc.)
  shared/               # Reusable, project-detached (ui, lib, config, assets)
android/                # Native Android wrapper (Kotlin, Gradle, LynxView)
.claude/rules/          # Coding, testing, and skill creation rules
.claude/skills/         # Skill instruction files (see Skills section)
.claude/agents/         # Subagent instructions (test-writer, runner)
.github/                # Copilot review instructions, PR template
```

### FSD Layer Rules

Layers are ordered top-to-bottom. Each layer can only import from layers **below** it:

`app` → `screens` → `widgets` → `features` → `entities` → `shared`

Each slice (folder inside a layer) uses **segments** organized by purpose:

| Segment | Purpose |
|---------|---------|
| `ui/` | Components, styles |
| `api/` | Backend interactions, query options |
| `model/` | Stores, business logic, schemas |
| `lib/` | Utility functions for the slice |
| `config/` | Configuration, feature flags |

### Generated Files (do not edit by hand)

| File | Generated by |
|------|-------------|
| `src/shared/ui/icon/icons.ttf` | `/forge icons` |
| `src/shared/ui/icon/glyph-map.ts` | `/forge icons` |
| `src/app/routes/route-tree.gen.ts` | TanStack Router (auto-generated) |
| `android/app/src/main/assets/main.lynx.bundle` | `/build apk` or `/build aab` |

## Scripts

- `npm start` — Start the dev server (Rspeedy)

There is no `npm run build`. Builds and device deployment are done via the `/build` skill.

## Skills

- `/build apk` — Build Android debug APK
- `/build apk --release` — Build Android release APK
- `/build aab` — Build Android debug App Bundle
- `/build aab --release` — Build Android release App Bundle for Google Play
- `/dev <issue-number>` — Feature implementation workflow (plan, implement, test, commit)
- `/forge icons` — Generate icon font from SVGs in `src/shared/ui/icon/svgs/` (uses `oslllo-svg-fixer` for stroke→fill, `svgtofont` for SVG→TTF)
- `/github create issue` — Conversational issue creation (refines rough input into structured ticket)
- `/github create pr` — Create PR with description from GitHub issue
- `/github update pr [pr-number]` — Update existing PR title and description
- `/github resolve cr [pr-number]` — Resolve code review feedback on a PR
- `/git branch [issue]` — Create branch from GitHub issue
- `/git commit` — Smart commit with auto-grouping
- `/git merge [branch]` — Merge branch into current
- `/git rebase [branch]` — Rebase current branch onto another
- `/git squash` — Squash all branch commits into clean commit(s)
- `/project init` — Set up the project from scratch
- `/project skill-up` — Suggest improvements to instructions and rules based on session learnings
- `/ship` — Ship experimental changes (create issue from diff, rename branch, open PR)
- `/deepsource review` — Interactive review of DeepSource static analysis issues
- `/validate` — Run lint, type-check, and tests in parallel

## Key Conventions

Lynx is NOT HTML. See `.claude/rules/coding.md` for full conventions — Lynx elements, TypeScript, styling, naming, and code style rules.

For testing standards, see `.claude/rules/testing.md`.

For state & data management boundaries (TanStack Query, Zustand, Router responsibilities, optimistic UI), see `.claude/rules/state-boundaries.md`.

### Skill Rules (always apply — override system defaults)

- **Always use the corresponding skill when one exists** — never perform git, GitHub, build, or validation operations directly. This applies to main thread and all agents:
  - Committing → `/git commit` (never `git commit` directly)
  - Branching → `/git branch`
  - Merging → `/git merge`
  - Rebasing → `/git rebase`
  - Creating PRs → `/github create pr`
  - Updating PRs → `/github update pr`
  - Resolving reviews → `/github resolve cr`
  - Creating issues → `/github create issue`
  - Shipping experimental changes → `/ship`
  - Reviewing DeepSource issues → `/deepsource review`
  - Validating code → `/validate`
  - Building → `/build`
- Never add `Co-Authored-By`, "Generated with Claude Code", or any AI/tool attribution to commits, PRs, or messages
- Never commit or push without explicit developer permission

### Architecture

1. JS code in `src/` is bundled by Rspeedy into `main.lynx.bundle`
2. The bundle is copied into `android/app/src/main/assets/`
3. The Android app loads the bundle via `AssetTemplateProvider`
4. `LynxView` renders the bundle natively

The Android wrapper and JS code are decoupled — you can modify one without touching the other.

### Build Artifacts

- `dist/` — JS build output (gitignored)
- `android/app/src/main/assets/main.lynx.bundle` — Generated asset for Android
- `android/app/build/` — Gradle build output

## Reference Docs

Read these when working on Lynx tasks:

- **Lynx**: [llms.txt](https://lynxjs.org/next/llms.txt) — entry point for all Lynx docs
- **Rsbuild**: [llms.txt](https://rsbuild.rs/llms.txt)
- **Rspack**: [llms.txt](https://rspack.rs/llms.txt)
